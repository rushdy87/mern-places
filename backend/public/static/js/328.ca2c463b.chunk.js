"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[328],{328:(e,t,a)=>{a.r(t),a.d(t,{NewPlace:()=>u,UpdatePlace:()=>h,UserPlaces:()=>v});var s=a(791),i=a(689),l=a(104),r=a(302),n=a(83),c=a(595),o=a(765),d=a(108),p=a(184);const u=()=>{const e=(0,i.s0)(),[t,a]=(0,o.cI)({title:{value:"",isValid:!1},description:{value:"",isValid:!1},address:{value:"",isValid:!1},image:{value:null,isValid:!1}},!1),{sendRequest:u,isLoading:h,error:x,clearError:m}=(0,o.xb)(),{token:v}=(0,s.useContext)(d.V);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.Cv,{error:x,onClear:m}),(0,p.jsxs)("form",{className:"place-form",onSubmit:async a=>{a.preventDefault();try{const a=new FormData;a.append("title",t.inputs.title.value),a.append("description",t.inputs.description.value),a.append("address",t.inputs.address.value),a.append("image",t.inputs.image.value),await u("".concat("http://localhost:3030/api","/places"),"POST",a,{Authorization:"Bearer ".concat(v)}),e("/")}catch(s){console.log(s)}},children:[h&&(0,p.jsx)(n.TK,{asOverlay:!0}),(0,p.jsx)(l.I,{id:"title",element:"input",type:"text",label:"Title",validators:[(0,c.hg)()],errorText:"Please enter a valid title.",onInput:a}),(0,p.jsx)(l.I,{id:"description",element:"textarea",label:"Description",validators:[(0,c.CP)(5)],errorText:"Please enter a valid description (at least 5 characters).",onInput:a}),(0,p.jsx)(l.I,{id:"address",element:"input",label:"Address",validators:[(0,c.hg)()],errorText:"Please enter a valid address.",onInput:a}),(0,p.jsx)(r.Z,{id:"image",onInput:a,errorText:"Please provied an image."}),(0,p.jsx)(l.z,{type:"submit",disabled:!t.isValid,children:"ADD PLACE"})]})]})},h=()=>{const[e,t]=(0,s.useState)(),a=(0,i.s0)(),{isLoading:r,error:u,sendRequest:h,clearError:x}=(0,o.xb)(),m=(0,i.UO)().placeId,{userId:v,token:j}=(0,s.useContext)(d.V),[g,C,f]=(0,o.cI)({title:{value:"",isValid:!1},description:{value:"",isValid:!1}},!1);(0,s.useEffect)((()=>{(async()=>{try{const{place:e}=await h("".concat("http://localhost:3030/api","/places/").concat(m));t(e),f({title:{value:e.title,isValid:!0},description:{value:e.description,isValid:!0}},!0)}catch(u){console.log(u)}})()}),[h,m,f]);return e||u?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.Cv,{error:u,onClear:x}),r?(0,p.jsx)(n.TK,{asOverlay:!0}):(0,p.jsxs)("form",{className:"place-form",onSubmit:async e=>{e.preventDefault();try{await h("".concat("http://localhost:3030/api","/places/").concat(m),"PATCH",JSON.stringify({title:g.inputs.title.value,description:g.inputs.description.value}),{"Content-Type":"application/json",Authorization:"Bearer ".concat(j)}),a("/".concat(v,"/place"))}catch(u){console.log(u)}},children:[(0,p.jsx)(l.I,{id:"title",element:"input",type:"text",label:"Title",validators:[(0,c.hg)()],errorText:"Please enter a valid title.",onInput:C,initialValue:g.inputs.title.value,initialValid:g.inputs.title.isValid}),(0,p.jsx)(l.I,{id:"description",element:"textarea",label:"Description",validators:[(0,c.CP)(5)],errorText:"Please enter a valid description (min. 5 characters).",onInput:C,initialValue:g.inputs.description.value,initialValid:g.inputs.description.isValid}),(0,p.jsx)(l.z,{type:"submit",disabled:!g.isValid,children:"UPDATE PLACE"})]})]}):(0,p.jsx)("div",{className:"center",children:(0,p.jsx)(n.Zb,{children:(0,p.jsx)("h2",{children:"Could not find place!"})})})},x=e=>{const[t,a]=(0,s.useState)(!1),[i,r]=(0,s.useState)(!1),{userId:c,token:u}=(0,s.useContext)(d.V),{isLoading:h,error:x,sendRequest:m,clearError:v}=(0,o.xb)(),j=()=>a(!1),g=()=>r(!1);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.Cv,{error:x,onClear:v}),(0,p.jsx)(n.u_,{show:t,onCancel:j,header:e.address,contentClass:"place-item__modal-content",footerClass:"place-item__modal-actions",footer:(0,p.jsx)(l.z,{onClick:j,children:"CLOSE"}),children:(0,p.jsx)("div",{className:"map-container",children:(0,p.jsx)(n.D5,{style:{background:"black"},center:e.coordinates,zoom:16})})}),(0,p.jsx)(n.u_,{show:i,onCancel:g,header:"Are you sure?",footerClass:"place-item__modal-actions",footer:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.z,{inverse:!0,onClick:g,children:"CANCEL"}),(0,p.jsx)(l.z,{danger:!0,onClick:async()=>{r(!1);try{await m("".concat("http://localhost:3030/api","/places/").concat(e.id),"DELETE",null,{Authorization:"Bearer ".concat(u)}),e.onDelete(e.id)}catch(x){console.log(x)}},children:"DELETE"})]}),children:(0,p.jsx)("p",{children:"Do you want to proced and delete this place? Please note it can be undone there after."})}),(0,p.jsx)("li",{className:"place-item",children:(0,p.jsxs)(n.Zb,{className:"place-item__content",children:[h&&(0,p.jsx)(n.TK,{asOverlay:!0}),(0,p.jsx)("div",{className:"place-item__image",children:(0,p.jsx)("img",{src:"".concat("http://localhost:3030","/").concat(e.image),alt:e.title})}),(0,p.jsxs)("div",{className:"place-item__info",children:[(0,p.jsx)("h2",{children:e.title}),(0,p.jsx)("h3",{children:e.address}),(0,p.jsx)("p",{children:e.description})]}),(0,p.jsxs)("div",{className:"place-item__actions",children:[(0,p.jsx)(l.z,{inverse:!0,onClick:()=>a(!0),children:"VIEW ON MAP"}),c===e.creatorId&&(0,p.jsx)(l.z,{to:"/places/".concat(e.id),children:"EDIT"}),c===e.creatorId&&(0,p.jsx)(l.z,{danger:!0,onClick:()=>r(!0),children:"DELETE"})]})]})})]})},m=e=>0===e.items.length?(0,p.jsx)("div",{className:"place-list center",children:(0,p.jsxs)(n.Zb,{children:[(0,p.jsx)("h2",{children:"No places found. Maybe create one?"}),(0,p.jsx)(l.z,{to:"/places/new",children:"Share Place"})]})}):(0,p.jsx)("ul",{className:"place-list",children:e.items.map((t=>(0,p.jsx)(x,{id:t.id,image:t.image,title:t.title,description:t.description,address:t.address,creatorId:t.creator,coordinates:t.location,onDelete:e.onDeletePlace},t.id)))}),v=()=>{const[e,t]=(0,s.useState)([]),{userId:a}=(0,i.UO)(),{isLoading:l,error:r,sendRequest:c,clearError:d}=(0,o.xb)();(0,s.useEffect)((()=>{(async()=>{try{const{places:e}=await c("".concat("http://localhost:3030/api","/places/user/").concat(a));t(e.filter((e=>e.creator===a)))}catch(r){console.log(r)}})()}),[c,a]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.Cv,{error:r,onClear:d}),l?(0,p.jsx)(n.TK,{asOverlay:!0}):(0,p.jsx)(m,{items:e,onDeletePlace:e=>{t((t=>t.filter((t=>t.id!==e))))}})]})}},104:(e,t,a)=>{a.d(t,{z:()=>s.Z,I:()=>c});var s=a(750),i=a(791),l=a(595),r=a(184);const n=(e,t)=>{switch(t.type){case"CHANGE":return{...e,value:t.val,isValid:(0,l.Gu)(t.val,t.validators)};case"TOUCH":return{...e,isTouched:!0};default:return e}},c=e=>{const[t,a]=(0,i.useReducer)(n,{value:e.initialValue||"",isTouched:!1,isValid:e.initialValid||!1}),{onInput:s,id:l}=e,{value:c,isValid:o}=t;(0,i.useEffect)((()=>{s(l,c,o)}),[s,l,c,o]);const d=t=>{a({type:"CHANGE",val:t.target.value,validators:e.validators})},p=()=>{a({type:"TOUCH"})},u="input"===e.element?(0,r.jsx)("input",{id:e.id,type:e.type,placeholder:e.placeholder,onChange:d,onBlur:p,value:t.value}):(0,r.jsx)("textarea",{id:e.id,rows:e.rows||3,onChange:d,onBlur:p,value:t.value});return(0,r.jsxs)("div",{className:"form-control ".concat(!t.isValid&&t.isTouched&&"form-control--invalid"),children:[(0,r.jsx)("label",{htmlFor:e.id,children:e.label}),u,!t.isValid&&t.isTouched&&(0,r.jsx)("p",{children:e.errorText})]})}},302:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(791),i=a(104),l=a(184);const r=e=>{const[t,a]=(0,s.useState)(),[r,n]=(0,s.useState)(""),[c,o]=(0,s.useState)(!1),d=(0,s.useRef)();(0,s.useEffect)((()=>{if(!t)return;const e=new FileReader;e.onload=()=>{n(e.result)},e.readAsDataURL(t)}),[t]);return(0,l.jsxs)("div",{className:"form-control",children:[(0,l.jsx)("input",{type:"file",ref:d,style:{display:"none"},name:"",id:e.id,accept:".jpg, .png, .jpeg",onChange:t=>{let s,i=c;t.target.files&&1===t.target.files.length?(s=t.target.files[0],a(s),o(!0),i=!0):(o(!1),i=!1),e.onInput(e.id,s,i)}}),(0,l.jsxs)("div",{className:"image-upload ".concat(e.center&&"center"),children:[(0,l.jsxs)("div",{className:"image-upload__preview",children:[r&&(0,l.jsx)("img",{src:r,alt:"Preview"}),!r&&(0,l.jsx)("p",{children:"Pleace pick an image."})]}),(0,l.jsx)(i.z,{type:"button",onClick:()=>{d.current.click()},children:"PiCK IMAGE"})]}),!c&&(0,l.jsx)("p",{children:e.errorText})]})}},595:(e,t,a)=>{a.d(t,{CP:()=>c,Gu:()=>d,Ox:()=>o,hg:()=>n});const s="REQUIRE",i="MINLENGTH",l="MAXLENGTH",r="EMAIL",n=()=>({type:s}),c=e=>({type:i,val:e}),o=()=>({type:r}),d=(e,t)=>{let a=!0;for(const n of t)n.type===s&&(a=a&&e.trim().length>0),n.type===i&&(a=a&&e.trim().length>=n.val),n.type===l&&(a=a&&e.trim().length<=n.val),"MIN"===n.type&&(a=a&&+e>=n.val),"MAX"===n.type&&(a=a&&+e<=n.val),n.type===r&&(a=a&&/^\S+@\S+\.\S+$/.test(e));return a}}}]);
//# sourceMappingURL=328.ca2c463b.chunk.js.map